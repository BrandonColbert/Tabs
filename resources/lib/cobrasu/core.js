var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.d(t,{Vt:()=>s,SO:()=>r,Up:()=>i,xv:()=>o,Ni:()=>n,Fr:()=>l});var r={};e.r(r),e.d(r,{Content:()=>d,Cookies:()=>c,DDListElement:()=>f,Dropdown:()=>g,Text:()=>v,UIElement:()=>h});var n={};e.r(n),e.d(n,{argmax:()=>p,argmin:()=>w,range:()=>E});class a{static convert(e,t){let r,n,a;switch(!0){case/^rgb/.test(e):[r,n,a]=e.match(/^rgb\s*\(\s*(\d+),\s*(\d+),\s*(\d+)\s*\)$/).slice(1).map((e=>parseInt(e)));break;case/^#/.test(e):[r,n,a]=e.match(/#([0-9a-fA-F][0-9a-fA-F])([0-9a-fA-F][0-9a-fA-F])([0-9a-fA-F][0-9a-fA-F])/).slice(1).map((e=>parseInt(`0x${e}`)));break;case/^hsl/.test(e):let[t,s,i]=e.match(/^hsl\s*\(\s*(\d+),\s*(\d+%),\s*(\d+%)\s*\)$/).slice(1),[o,l,d]=[parseFloat(t),parseFloat(s.slice(0,-1))/100,parseFloat(i.slice(0,-1))/100],c=(1-Math.abs(2*d-1))*l,h=c*(1-Math.abs(o/60%2-1)),u=d-c/2;switch(!0){case o<60:[r,n,a]=[c,h,0];break;case o<120:[r,n,a]=[h,c,0];break;case o<180:[r,n,a]=[0,c,h];break;case o<240:[r,n,a]=[0,h,c];break;case o<300:[r,n,a]=[h,0,c];break;case o<360:[r,n,a]=[c,0,h]}[r,n,a]=[Math.round(255*(r+u)),Math.round(255*(n+u)),Math.round(255*(a+u))];break;default:throw new Error(`Unrecognized format of '${e}'`)}switch(t){case"rgb":return`rgb(${r}, ${n}, ${a})`;case"hex":function e(e){let t=e.toString(16);return 1===t.length?`0${t}`:t}return`#${e(r)}${e(n)}${e(a)}`;case"hsl":{let e,t,s;[r,n,a]=[r/255,n/255,a/255];let[i,o]=[Math.min(r,n,a),Math.max(r,n,a)],l=o-i;switch(s=(o+i)/2,t=0==l?0:l/(1-Math.abs(2*s-1)),!0){case 0==l:e=0;break;case o==r:e=(n-a)/l%6*60;break;case o==n:e=60*((a-r)/l+2);break;case o==a:e=60*((r-n)/l+4)}return`hsl(${e}, ${(100*t).toFixed(0)}%, ${(100*s).toFixed(0)}%)`}default:throw new Error(`Invalid color format '${t}'`)}}static*wheel(e,t="hex"){for(let r=0;r<e;r++)yield a.convert(`hsl(${r*(360/e)%360}, 100%, 50%)`,t)}}const s=a,i=class{#e;constructor(...e){this.#e=new Map,e&&this.register(...e)}async fire(e,t){await Promise.all([...this.#e.get(e.toString())].map((e=>e(t))))}on(e,t){return this.#e.get(e.toString()).add(t),t}once(e,t){let r;return r=n=>{t(n),this.forget(e,r)},this.on(e,r)}forget(e,t){this.#e.get(e.toString()).delete(t)}forgetAll(){for(let[,e]of this.#e)e.clear()}register(...e){for(let t of e)this.#e.has(t.toString())?console.error(`Event ${t} is already registered`):this.#e.set(t.toString(),new Set)}unregister(...e){for(let t of e)this.#e.has(t.toString())?this.#e.delete(t.toString()):console.error(`Event ${t} is not registered`)}};class o{static simplify(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}static transformToName(e){return e.replace(/^[a-z]/,(e=>e.toUpperCase())).replace(/([a-z])([A-Z])/g,((e,...t)=>`${t[0]} ${t[1]}`))}}function l(...e){let t,r,n;if(0==e.length)throw new Error("Expected at least 1 parameter");switch(typeof e[0]){case"object":[t,r,...n]=e,r=r.bind(t);break;case"function":[r,...n]=e;break;default:throw new Error(`First parameter is unexpected type '${typeof e[0]}'`)}return new Promise((e=>r(...n,((...t)=>e(t)))))}class d{static async fetch(e){return new Promise(((t,r)=>{const n=new XMLHttpRequest;n.onerror=()=>r("Request encountered a network error"),n.ontimeout=()=>r(`Request timed out after ${n.timeout}ms`),n.onload=()=>{4===n.readyState&&(200===n.status?t(n.responseText):r(`Request status was ${n.status}`))},n.open("GET",e,!0),n.send()}))}}class c{static get(e,t,r){let n=new Map(this);if(!n.has(e))return r??null;let a=n.get(e);switch(t){case Object:return JSON.parse(a);case String:return a;case Number:return parseFloat(a);case Boolean:switch(a){case"true":return!0;case"false":return!1;default:return null}default:throw new Error(`Unable to get value for '${e}' as '${t.name}'`)}}static set(e,t){document.cookie="object"==typeof t?`${e}=${JSON.stringify(t)}`:`${e}=${t}`}static has(e){return[...this].map((([e])=>e)).includes(e)}static delete(e){c.set(e,"; expires=Thu, 01 Jan 1970 00:00:01 GMT;")}static clear(){for(let[e]of this)c.delete(e)}static*[Symbol.iterator](){for(let e of document.cookie.split(";")){let[t,r]=e.split("=");t=t.trim(),yield[t,r]}}}class h extends(globalThis.HTMLElement??null){mutationObserver;constructor(){super(),this.mutationObserver=new MutationObserver(((e,t)=>{for(let t of e)"childList"===t.type&&(t.addedNodes.forEach((e=>this.onChildAttached(e))),t.removedNodes.forEach((e=>this.onChildDetached(e))))}))}attached(){}detached(){}onChildAttached(e){}onChildDetached(e){}connectedCallback(){this.mutationObserver.observe(this,{childList:!0}),this.isConnected&&this.attached()}disconnectedCallback(){this.mutationObserver.disconnect(),this.detached()}static register(e,t){let r,n;if(e)if(t)r=e,n=t;else switch(typeof e){case"string":r=e;break;case"function":n=t}else t&&(r=t);n||(n=this),r||(r=`ui-${n.name.replace(/Element$/,(e=>"")).replace(/^[A-Z]/,(e=>e.toLowerCase())).replace(/[A-Z]/,(e=>`-${e.toLowerCase()}`))}`),globalThis.customElements?.define(r,n)}static restrict(e,t){if(!(e instanceof t)){if(!e)throw new Error("Expected node, none provided");throw new Error(`Expected type ${t.name}, but got type ${e.constructor.name} with ${e}`)}}}class u extends h{static image=globalThis.Image?new globalThis.Image:null;static#t=0;events;dataBind;activeElement;moveCancel;constructor(){super(),this.events=new i("drop","reorder","transfer")}get id(){return super.id||(super.id="ddl_"+u.#t++),super.id}attached(){for(let e of Array.from(this.children))e instanceof HTMLElement&&this.include(e)}detached(){for(let e of Array.from(this.children))e instanceof HTMLElement&&this.exclude(e)}onChildAttached(e){h.restrict(e,HTMLElement),this.include(e)}onChildDetached(e){this.exclude(e)}include(e){(e=u.underview(e)).draggable=!0,e.addEventListener("dragstart",this.onChildDrag),e.addEventListener("drop",this.onDropIntoChild),e.addEventListener("dragenter",this.onChildDragEnter),e.addEventListener("dragend",this.onChildDragEnd),e.addEventListener("dragover",this.onChildDragOver)}exclude(e){(e=u.underview(e)).draggable=!1,e.removeEventListener("dragstart",this.onChildDrag),e.removeEventListener("drop",this.onDropIntoChild),e.removeEventListener("dragenter",this.onChildDragEnter),e.removeEventListener("dragend",this.onChildDragEnd),e.removeEventListener("dragover",this.onChildDragOver)}onChildDrag=e=>{if(!e.dataTransfer)return;e.target.classList.add("reorderTarget");let t=u.overview(e.target),r=Array.from(this.children).indexOf(t);this.activeElement=t,this.moveCancel=()=>{let e=Array.from(this.children).indexOf(t)>r?r:r+1;this.insertBefore(t,e<this.children.length?this.children[e]:null)},e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setDragImage(u.image,0,0),e.dataTransfer.setData("text/plain",JSON.stringify({selector:`#${this.id}`,index:r,data:this.dataBind?this.dataBind(r):{}}))};onDropIntoChild=async e=>{if(!e.dataTransfer)return;let t;try{t=JSON.parse(e.dataTransfer.getData("text/plain"))}catch(e){return}if(!("selector"in t&&"index"in t&&"data"in t))return;let r=document.querySelector(t.selector);if(r.activeElement=null,r==this){let r=u.overview(e.target),n=Array.from(this.children).indexOf(r),a=t.index;if(a==n)return;await this.events.fire("reorder",{from:a,to:n,cancel:this.moveCancel??(()=>{throw new Error("Unable to cancel move")})})}else{let n=!1,a=u.overview(e.target),s=a?.parentElement;if(!a)return;if(await s.events.fire("drop",{index:Array.from(s.children).indexOf(a),data:t.data,cancel:()=>n=!0}),n)return void r.moveCancel();await r.events.fire("transfer",{index:t.index,target:s})}};onChildDragEnter=e=>{let t=Array.from(this.children),r=u.overview(this.activeElement),n=u.overview(e.target),a=t.indexOf(r),s=t.indexOf(n);a!=s&&-1!=a&&-1!=s&&this.insertBefore(r,a<s?n.nextElementSibling:n)};onChildDragEnd=e=>{this.activeElement&&this.moveCancel(),this.activeElement=null,e.target.classList.remove("reorderTarget")};onChildDragOver=e=>e.preventDefault();static underview(e){return 1==e instanceof HTMLDetailsElement?e.querySelector("summary"):e}static overview(e){return e?e.parentElement instanceof u?e:e.closest("dd-list > *"):null}}u.register("dd-list");const f=u;class m{element;constructor(){this.element=document.createElement("div"),this.element.tabIndex=-1,this.element.addEventListener("blur",this.#r),window.addEventListener("keydown",this.#n)}close(){window.removeEventListener("keydown",this.#n),this.element.removeEventListener("blur",this.#r),this.element.remove()}#n=e=>{"Escape"===e.code&&this.close()};#r=e=>{e.relatedTarget!=this.element&&(e.relatedTarget instanceof Node&&e.relatedTarget?.parentNode==this.element||this.close())};static show(e,t={}){let r=new m,{element:n}=r;document.body.append(n);for(let t of e){let e=document.createElement("button");e.textContent=t.text,e.addEventListener("blur",r.#r),e.addEventListener("click",(n=>{e.removeEventListener("blur",r.#r),t.callback?.(n),r.close()})),n.append(e)}let{style:a}=n;if(n.classList.add("dropdown"),null!=t.height&&(a.overflowY="auto",a.maxHeight=t.height.toString()),t.position){let[e,r]=t.position;a.left=e.toString(),a.top=r.toString()}else if(t.target){let[r,s]=[n.clientWidth,n.clientHeight/e.length*(e.length+1)],i=t.target.getBoundingClientRect(),[o,l]=[i.x,i.bottom],[d,c]=[o+r,l+s],[h,u]=[window.innerWidth,window.innerHeight];a.left=`${(d>h?o-r:o)+window.scrollX}px`,a.top=`${(c>u?l-s:l)+window.scrollY}px`}else a.left="0px",a.top="0px";return n.focus(),r}}const g=m;class v extends o{static rename(e){let t=e.textContent;function r(){e.contentEditable="false",e.scrollLeft=0}return new Promise((n=>{let a,s;a=t=>{switch(t.code){case"Enter":e.removeEventListener("blur",s),e.removeEventListener("keydown",a),e.blur(),r(),e.textContent||n(null),n(e.textContent);break;case"Escape":e.blur()}},s=()=>{e.removeEventListener("keydown",a),e.textContent=t,r(),n(null)},e.addEventListener("keydown",a),e.addEventListener("blur",s,{once:!0}),e.contentEditable="true",e.focus()}))}}function p(...e){if(0==e.length)return-1;let t=e[0],r=0;return e.slice(1).forEach(((e,n)=>{e>t&&(t=e,r=n+1)})),r}function w(...e){if(0==e.length)return-1;let t=e[0],r=0;return e.slice(1).forEach(((e,n)=>{e<t&&(t=e,r=n+1)})),r}function E(e,t){if(t){let r=e,n=t;return r+Math.random()*(n-r)}return e?e*Math.random():Math.random()}var b=t.Vt,x=t.SO,y=t.Up,C=t.xv,L=t.Ni,$=t.Fr;export{b as Colorizer,x as DOM,y as Dispatcher,C as Text,L as mathx,$ as promisify};